apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: infra
  namespace: argo-cd
spec:
  description: "infra 相关组件 cilium istio local-path-storage minio cert-manager"

  # 允许同步的 Git 仓库
  sourceRepos:
    - "git@github.com:bsonger/devops-config.git"

  # 允许部署的集群和命名空间
  destinations:
    - namespace: default
      server: https://kubernetes.default.svc
    - namespace: kube-system
      server: https://kubernetes.default.svc
    - namespace: cert-manager
      server: https://kubernetes.default.svc
    - namespace: cilium
      server: https://kubernetes.default.svc
    - namespace: istio-system
      server: https://kubernetes.default.svc
    - namespace: local-path-storage
      server: https://kubernetes.default.svc
    - namespace: cilium-secrets
      server: https://kubernetes.default.svc
    - namespace: minio
      server: https://kubernetes.default.svc
  # 允许操作所有集群级资源
  clusterResourceWhitelist:
    - group: "*"
      kind: "*"

  # 不限制命名空间资源
  namespaceResourceBlacklist: []

  # Roles（可选，如果不创建则默认权限由 Argo CD RBAC 决定）
  roles: []