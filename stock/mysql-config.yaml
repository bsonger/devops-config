apiVersion: v1
kind: ConfigMap
metadata:
  name: mysql-config
data:
  my.cnf: |
    [client]
    socket=/var/lib/mysql/mysql.sock
    port=3306

    [mysqld]
    basedir=/var/lib/mysql/
    datadir=/var/lib/mysql/data
    socket=/var/lib/mysql/mysql.sock
    default-storage-engine=INNODB
    character_set_server=utf8mb4
    collation_server=utf8mb4_general_ci
    port=3306

    # Disabling symbolic-links is recommended to prevent assorted security risks
    symbolic-links=0
    server_id=1

    ## 最大连接数
    max_connections = 1000

    ## 启用 per-table 表空间，减少 ibdata1 膨胀
    innodb_file_per_table = 1

    ## InnoDB 缓存配置优化
    innodb_buffer_pool_size = 2048M
    innodb_log_file_size = 512M
    innodb_log_buffer_size = 8M
    innodb_flush_log_at_trx_commit = 2

    ## 表名不区分大小写（适用于 Windows/Linux 跨平台开发）
    lower_case_table_names = 1

    ## 安装期间可临时开启跳过权限（建议后续注释）
    # skip-grant-tables

    ## 关闭 binlog（可选）
    skip-log-bin
